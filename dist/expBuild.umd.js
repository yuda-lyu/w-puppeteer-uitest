/*!
 * expBuild v1.0.39
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs"),require("puppeteer")):"function"==typeof define&&define.amd?define(["fs","puppeteer"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).expBuild=e(t.fs,t.puppeteer)}(this,(function(t,e){"use strict";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var o=Array.isArray,a="object"==typeof r&&r&&r.Object===Object&&r,i=a,u="object"==typeof self&&self&&self.Object===Object&&self,c=i||u||Function("return this")(),s=c.Symbol,f=s,l=Object.prototype,p=l.hasOwnProperty,v=l.toString,h=f?f.toStringTag:void 0;var y=function(t){var e=p.call(t,h),r=t[h];try{t[h]=void 0;var n=!0}catch(t){}var o=v.call(t);return n&&(e?t[h]=r:delete t[h]),o},w=Object.prototype.toString;var d=y,b=function(t){return w.call(t)},g=s?s.toStringTag:void 0;var _=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":g&&g in Object(t)?d(t):b(t)};var j=function(t){return null!=t&&"object"==typeof t},m=_,x=j;var O=function(t){return"symbol"==typeof t||x(t)&&"[object Symbol]"==m(t)},F=o,k=O,S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/;var P=function(t,e){if(F(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!k(t))||(A.test(t)||!S.test(t)||null!=e&&t in Object(e))};var $=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},C=_,z=$;var T,E=function(t){if(!z(t))return!1;var e=C(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},B=c["__core-js_shared__"],N=(T=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"";var M=function(t){return!!N&&N in t},I=Function.prototype.toString;var L=function(t){if(null!=t){try{return I.call(t)}catch(t){}try{return t+""}catch(t){}}return""},U=E,R=M,V=$,q=L,D=/^\[object .+?Constructor\]$/,W=Function.prototype,G=Object.prototype,H=W.toString,J=G.hasOwnProperty,K=RegExp("^"+H.call(J).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Q=function(t){return!(!V(t)||R(t))&&(U(t)?K:D).test(q(t))},X=function(t,e){return null==t?void 0:t[e]};var Y=function(t,e){var r=X(t,e);return Q(r)?r:void 0},Z=Y(Object,"create"),tt=Z;var et=function(){this.__data__=tt?tt(null):{},this.size=0};var rt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},nt=Z,ot=Object.prototype.hasOwnProperty;var at=function(t){var e=this.__data__;if(nt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return ot.call(e,t)?e[t]:void 0},it=Z,ut=Object.prototype.hasOwnProperty;var ct=Z;var st=et,ft=rt,lt=at,pt=function(t){var e=this.__data__;return it?void 0!==e[t]:ut.call(e,t)},vt=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ct&&void 0===e?"__lodash_hash_undefined__":e,this};function ht(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ht.prototype.clear=st,ht.prototype.delete=ft,ht.prototype.get=lt,ht.prototype.has=pt,ht.prototype.set=vt;var yt=ht;var wt=function(){this.__data__=[],this.size=0};var dt=function(t,e){return t===e||t!=t&&e!=e};var bt=function(t,e){for(var r=t.length;r--;)if(dt(t[r][0],e))return r;return-1},gt=bt,_t=Array.prototype.splice;var jt=bt;var mt=bt;var xt=bt;var Ot=wt,Ft=function(t){var e=this.__data__,r=gt(e,t);return!(r<0)&&(r==e.length-1?e.pop():_t.call(e,r,1),--this.size,!0)},kt=function(t){var e=this.__data__,r=jt(e,t);return r<0?void 0:e[r][1]},St=function(t){return mt(this.__data__,t)>-1},At=function(t,e){var r=this.__data__,n=xt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function Pt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Pt.prototype.clear=Ot,Pt.prototype.delete=Ft,Pt.prototype.get=kt,Pt.prototype.has=St,Pt.prototype.set=At;var $t=Pt,Ct=Y(c,"Map"),zt=yt,Tt=$t,Et=Ct;var Bt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var Nt=function(t,e){var r=t.__data__;return Bt(e)?r["string"==typeof e?"string":"hash"]:r.map},Mt=Nt;var It=Nt;var Lt=Nt;var Ut=Nt;var Rt=function(t,e){var r=Ut(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},Vt=function(){this.size=0,this.__data__={hash:new zt,map:new(Et||Tt),string:new zt}},qt=function(t){var e=Mt(this,t).delete(t);return this.size-=e?1:0,e},Dt=function(t){return It(this,t).get(t)},Wt=function(t){return Lt(this,t).has(t)},Gt=Rt;function Ht(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ht.prototype.clear=Vt,Ht.prototype.delete=qt,Ht.prototype.get=Dt,Ht.prototype.has=Wt,Ht.prototype.set=Gt;var Jt=Ht;function Kt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var i=t.apply(this,n);return r.cache=a.set(o,i)||a,i};return r.cache=new(Kt.Cache||Jt),r}Kt.Cache=Jt;var Qt=Kt;var Xt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Yt=/\\(\\)?/g,Zt=function(t){var e=Qt(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Xt,(function(t,r,n,o){e.push(n?o.replace(Yt,"$1"):r||t)})),e}));var te=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o},ee=te,re=o,ne=O,oe=s?s.prototype:void 0,ae=oe?oe.toString:void 0;var ie=function t(e){if("string"==typeof e)return e;if(re(e))return ee(e,t)+"";if(ne(e))return ae?ae.call(e):"";var r=e+"";return"0"==r&&1/e==-Infinity?"-0":r},ue=ie;var ce=function(t){return null==t?"":ue(t)},se=o,fe=P,le=Zt,pe=ce;var ve=O;var he=function(t,e){return se(t)?t:fe(t,e)?[t]:le(pe(t))},ye=function(t){if("string"==typeof t||ve(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var we=function(t,e){for(var r=0,n=(e=he(e,t)).length;null!=t&&r<n;)t=t[ye(e[r++])];return r&&r==n?t:void 0};var de=function(t,e,r){var n=null==t?void 0:we(t,e);return void 0===n?r:n},be=/\s/;var ge=function(t){for(var e=t.length;e--&&be.test(t.charAt(e)););return e},_e=/^\s+/;var je=function(t){return t?t.slice(0,ge(t)+1).replace(_e,""):t},me=$,xe=O,Oe=/^[-+]0x[0-9a-f]+$/i,Fe=/^0b[01]+$/i,ke=/^0o[0-7]+$/i,Se=parseInt;var Ae=function(t){if("number"==typeof t)return t;if(xe(t))return NaN;if(me(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=me(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=je(t);var r=Fe.test(t);return r||ke.test(t)?Se(t.slice(2),r?2:8):Oe.test(t)?NaN:+t},Pe=Ae,$e=1/0;var Ce=function(t){return t?(t=Pe(t))===$e||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0},ze=Ce;var Te=function(t){var e=ze(t),r=e%1;return e==e?r?e-r:e:0},Ee=Te;var Be=function(t){return"number"==typeof t&&t==Ee(t)};function Ne(t){return"[object String]"===Object.prototype.toString.call(t)}function Me(t){let e=!1;return!function(t){return!(!Ne(t)||""===t)}(t)?function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)&&(e=!0):e=!isNaN(Number(t)),e}function Ie(t){if(!Me(t))return 0;return Ce(t)}function Le(t){return!!Me(t)&&(t=Ie(t),Be(t))}var Ue=Te,Re=Ae,Ve=ce,qe=c.isFinite,De=Math.min;var We=function(t){var e=Math[t];return function(t,r){if(t=Re(t),(r=null==r?0:De(Ue(r),292))&&qe(t)){var n=(Ve(t)+"e").split("e"),o=e(n[0]+"e"+(+n[1]+r));return+((n=(Ve(o)+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round");function Ge(t){if(!Me(t))return 0;t=Ie(t);let e=We(t);return"0"===String(e)?0:e}var He={},Je={get exports(){return He},set exports(t){He=t}};var Ke=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t};var Qe=function(t){return function(e,r,n){for(var o=-1,a=Object(e),i=n(e),u=i.length;u--;){var c=i[t?u:++o];if(!1===r(a[c],c,a))break}return e}}();var Xe=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n},Ye=_,Ze=j;var tr=function(t){return Ze(t)&&"[object Arguments]"==Ye(t)},er=j,rr=Object.prototype,nr=rr.hasOwnProperty,or=rr.propertyIsEnumerable,ar=tr(function(){return arguments}())?tr:function(t){return er(t)&&nr.call(t,"callee")&&!or.call(t,"callee")},ir=ar,ur={};var cr=function(){return!1};!function(t,e){var r=c,n=cr,o=e&&!e.nodeType&&e,a=o&&t&&!t.nodeType&&t,i=a&&a.exports===o?r.Buffer:void 0,u=(i?i.isBuffer:void 0)||n;t.exports=u}({get exports(){return ur},set exports(t){ur=t}},ur);var sr=/^(?:0|[1-9]\d*)$/;var fr=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&sr.test(t))&&t>-1&&t%1==0&&t<e};var lr=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},pr=_,vr=lr,hr=j,yr={};yr["[object Float32Array]"]=yr["[object Float64Array]"]=yr["[object Int8Array]"]=yr["[object Int16Array]"]=yr["[object Int32Array]"]=yr["[object Uint8Array]"]=yr["[object Uint8ClampedArray]"]=yr["[object Uint16Array]"]=yr["[object Uint32Array]"]=!0,yr["[object Arguments]"]=yr["[object Array]"]=yr["[object ArrayBuffer]"]=yr["[object Boolean]"]=yr["[object DataView]"]=yr["[object Date]"]=yr["[object Error]"]=yr["[object Function]"]=yr["[object Map]"]=yr["[object Number]"]=yr["[object Object]"]=yr["[object RegExp]"]=yr["[object Set]"]=yr["[object String]"]=yr["[object WeakMap]"]=!1;var wr=function(t){return hr(t)&&vr(t.length)&&!!yr[pr(t)]};var dr=function(t){return function(e){return t(e)}},br={};!function(t,e){var r=a,n=e&&!e.nodeType&&e,o=n&&t&&!t.nodeType&&t,i=o&&o.exports===n&&r.process,u=function(){try{var t=o&&o.require&&o.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=u}({get exports(){return br},set exports(t){br=t}},br);var gr=wr,_r=dr,jr=br&&br.isTypedArray,mr=jr?_r(jr):gr,xr=Xe,Or=ir,Fr=o,kr=ur,Sr=fr,Ar=mr,Pr=Object.prototype.hasOwnProperty;var $r=function(t,e){var r=Fr(t),n=!r&&Or(t),o=!r&&!n&&kr(t),a=!r&&!n&&!o&&Ar(t),i=r||n||o||a,u=i?xr(t.length,String):[],c=u.length;for(var s in t)!e&&!Pr.call(t,s)||i&&("length"==s||o&&("offset"==s||"parent"==s)||a&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Sr(s,c))||u.push(s);return u},Cr=Object.prototype;var zr=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Cr)};var Tr=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Er=zr,Br=Tr,Nr=Object.prototype.hasOwnProperty;var Mr=function(t){if(!Er(t))return Br(t);var e=[];for(var r in Object(t))Nr.call(t,r)&&"constructor"!=r&&e.push(r);return e},Ir=E,Lr=lr;var Ur=function(t){return null!=t&&Lr(t.length)&&!Ir(t)},Rr=$r,Vr=Mr,qr=Ur;var Dr=function(t){return qr(t)?Rr(t):Vr(t)},Wr=Qe,Gr=Dr;var Hr=Ur;var Jr=function(t,e){return function(r,n){if(null==r)return r;if(!Hr(r))return t(r,n);for(var o=r.length,a=e?o:-1,i=Object(r);(e?a--:++a<o)&&!1!==n(i[a],a,i););return r}}((function(t,e){return t&&Wr(t,e,Gr)}));var Kr=function(t){return t};var Qr=Ke,Xr=Jr,Yr=function(t){return"function"==typeof t?t:Kr},Zr=o;var tn=function(t,e){return(Zr(t)?Qr:Xr)(t,Yr(e))};!function(t){t.exports=tn}(Je);var en=n(He),rn=Y(c,"DataView"),nn=Ct,on=Y(c,"Promise"),an=Y(c,"Set"),un=Y(c,"WeakMap"),cn=_,sn=L,fn="[object Map]",ln="[object Promise]",pn="[object Set]",vn="[object WeakMap]",hn="[object DataView]",yn=sn(rn),wn=sn(nn),dn=sn(on),bn=sn(an),gn=sn(un),_n=cn;(rn&&_n(new rn(new ArrayBuffer(1)))!=hn||nn&&_n(new nn)!=fn||on&&_n(on.resolve())!=ln||an&&_n(new an)!=pn||un&&_n(new un)!=vn)&&(_n=function(t){var e=cn(t),r="[object Object]"==e?t.constructor:void 0,n=r?sn(r):"";if(n)switch(n){case yn:return hn;case wn:return fn;case dn:return ln;case bn:return pn;case gn:return vn}return e});var jn=_n,mn=_,xn=o,On=j;var Fn=function(t){return"string"==typeof t||!xn(t)&&On(t)&&"[object String]"==mn(t)};var kn=function(t){return function(e){return null==e?void 0:e[t]}}("length"),Sn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var An=function(t){return Sn.test(t)},Pn="\\ud800-\\udfff",$n="["+Pn+"]",Cn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",zn="\\ud83c[\\udffb-\\udfff]",Tn="[^"+Pn+"]",En="(?:\\ud83c[\\udde6-\\uddff]){2}",Bn="[\\ud800-\\udbff][\\udc00-\\udfff]",Nn="(?:"+Cn+"|"+zn+")"+"?",Mn="[\\ufe0e\\ufe0f]?",In=Mn+Nn+("(?:\\u200d(?:"+[Tn,En,Bn].join("|")+")"+Mn+Nn+")*"),Ln="(?:"+[Tn+Cn+"?",Cn,En,Bn,$n].join("|")+")",Un=RegExp(zn+"(?="+zn+")|"+Ln+In,"g");var Rn=kn,Vn=An,qn=function(t){for(var e=Un.lastIndex=0;Un.test(t);)++e;return e};var Dn=Mr,Wn=jn,Gn=Ur,Hn=Fn,Jn=function(t){return Vn(t)?qn(t):Rn(t)};var Kn=function(t){if(null==t)return 0;if(Gn(t))return Hn(t)?Jn(t):t.length;var e=Wn(t);return"[object Map]"==e||"[object Set]"==e?t.size:Dn(t).length},Qn=te;var Xn=function(t,e){return Qn(e,(function(e){return t[e]}))},Yn=Dr;var Zn=function(t){return null==t?[]:Xn(t,Yn(t))};function to(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}function eo(t){return"[object Array]"===Object.prototype.toString.call(t)}function ro(t){return"[object Object]"===Object.prototype.toString.call(t)}function no(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}var oo={};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function a(t,e,n,a,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var u=new o(n,a||t,i),c=r?r+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],u]:t._events[c].push(u):(t._events[c]=u,t._eventsCount++),t}function i(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function u(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},u.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,a=n.length,i=new Array(a);o<a;o++)i[o]=n[o].fn;return i},u.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},u.prototype.emit=function(t,e,n,o,a,i){var u=r?r+t:t;if(!this._events[u])return!1;var c,s,f=this._events[u],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,n),!0;case 4:return f.fn.call(f.context,e,n,o),!0;case 5:return f.fn.call(f.context,e,n,o,a),!0;case 6:return f.fn.call(f.context,e,n,o,a,i),!0}for(s=1,c=new Array(l-1);s<l;s++)c[s-1]=arguments[s];f.fn.apply(f.context,c)}else{var p,v=f.length;for(s=0;s<v;s++)switch(f[s].once&&this.removeListener(t,f[s].fn,void 0,!0),l){case 1:f[s].fn.call(f[s].context);break;case 2:f[s].fn.call(f[s].context,e);break;case 3:f[s].fn.call(f[s].context,e,n);break;case 4:f[s].fn.call(f[s].context,e,n,o);break;default:if(!c)for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];f[s].fn.apply(f[s].context,c)}}return!0},u.prototype.on=function(t,e,r){return a(this,t,e,r,!1)},u.prototype.once=function(t,e,r){return a(this,t,e,r,!0)},u.prototype.removeListener=function(t,e,n,o){var a=r?r+t:t;if(!this._events[a])return this;if(!e)return i(this,a),this;var u=this._events[a];if(u.fn)u.fn!==e||o&&!u.once||n&&u.context!==n||i(this,a);else{for(var c=0,s=[],f=u.length;c<f;c++)(u[c].fn!==e||o&&!u[c].once||n&&u[c].context!==n)&&s.push(u[c]);s.length?this._events[a]=1===s.length?s[0]:s:i(this,a)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&i(this,e)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u}({get exports(){return oo},set exports(t){oo=t}});var ao=oo;function io(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=0,r=[];var n;Le(n=t)&&Ge(n)<0&&(t=0),t=Ge(t);let o=new ao;return o.get=function(){if(r.length>0){return e+=1,r.splice(0,1)[0]}return null},o.cb=function(){e-=1,e<0&&(e=0),r.length>0&&o.emit("message",r)},o.push=function(n){r.push(n),(t<=0||e<t)&&o.emit("message",r)},o.clear=function(){e=0,r=[]},o}var uo=_,co=j;var so=function(t){return!0===t||!1===t||co(t)&&"[object Boolean]"==uo(t)};function fo(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(ro(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!Ne(t)||""!==t)}(t)||!!function(t){return!!eo(t)&&0===t.length}(t))))}var lo=function(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var a=Array(o);++n<o;)a[n]=t[n+e];return a},po=Te;var vo=function(t,e,r){var n=null==t?0:t.length;return n?(e=r||void 0===e?1:po(e),lo(t,e<0?0:e,n)):[]};async function ho(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=de(r,"headless");so(n)||(n=!0);let o=de(r,"viewport");ro(o)||(o={x:0,y:0,width:800,height:600});let a=de(r,"actions");eo(a)||(a=[]);let i=de(r,"waitsec");Le(i)||(i=5);let u={headless:n,slowMo:20},c=await e.launch(u),s=await c.newPage();async function f(t){let e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(r=Ge(r),0===r){if(e=await s.$(t),fo(e))return console.log("page.$ get no result: "+t),null}else{let n=await s.$$(t);if(0===n.length)return console.log("page.$$ get no result: "+t),null;e=r<0?n[n.length+r]:n[r]}if(fo(e))return console.log("invalid ele: "+t),null;if(fo(e.boundingBox))return console.log("invalid ele.boundingBox: "+t),null;let n=await e.boundingBox();return n.cx=n.x+n.width/2,n.cy=n.y+n.height/2,n.ele=e,n}await s.goto(t),await s.setViewport(o),await s.waitFor(1e3*i),await function(t,e){let r=to();if(!eo(t)&&!ro(t))return r.reject("rs is not an array or object"),r;let n=!1;if(ro(t)){n=!0;let e=[];en(t,((t,r)=>{e.push({k:r,v:t})})),t=e}no(e)||(e=function(t){return t});let o=-1,a=[];return t.reduce((function(t,r){return t.then((function(t){a.push(t),o+=1;let i=o,u=r;return n&&(i=r.k,u=r.v),no(e)?e(u,i):u}))}),Promise.resolve()).then((function(t){a.push(t),a=vo(a),r.resolve(a)})).catch((function(t){r.reject(t)})),r}(a,(async function(t){if("wait"===t.mode)await s.waitFor(t.time);else if("resize"===t.mode)await s.waitFor(300),await s.setViewport({x:0,y:0,width:t.width,height:t.height}),await s.waitFor(300);else if("move"===t.mode)await s.waitFor(300),await s.mouse.move(t.x1,t.y1),await s.waitFor(300);else if("elemove"===t.mode){await s.waitFor(300);let e=await f(t.selector,t.nth);e&&(await s.mouse.move(e.cx,e.cy),await s.waitFor(300))}else if("elehover"===t.mode)await s.waitFor(300),await s.hover(t.selector),await s.waitFor(300);else if("drag"===t.mode)await s.waitFor(300),await s.mouse.move(t.x1,t.y1),await s.mouse.down(),await s.waitFor(300),await s.mouse.move(t.x2,t.y2,{steps:50}),await s.waitFor(300),await s.mouse.up(),await s.waitFor(300);else if("eledrag"===t.mode){await s.waitFor(300);let e=await f(t.selector,t.nth);e&&(await s.mouse.move(e.cx,e.cy),await s.mouse.down(),await s.waitFor(300),await s.mouse.move(e.cx+t.shiftx,e.cy+t.shifty,{steps:50}),await s.waitFor(300),await s.mouse.up(),await s.waitFor(300))}else if("click"===t.mode)await s.waitFor(300),await s.mouse.move(t.x1,t.y1),await s.mouse.down(),await s.mouse.up(),await s.waitFor(300);else if("eleclick"===t.mode){await s.waitFor(300);let e=await f(t.selector,t.nth);e&&(await e.ele.click(),await s.waitFor(300))}else if("dbclick"===t.mode)await s.waitFor(300),await s.mouse.click(t.x1,t.y1,{clickCount:2}),await s.waitFor(300);else if("eledbclick"===t.mode){await s.waitFor(300);let e=await f(t.selector,t.nth);e&&(await e.ele.click({clickCount:2}),await s.waitFor(300))}else if("type"===t.mode)await s.waitFor(300),await s.keyboard.type(t.str,{delay:50}),t.noEnter||await s.keyboard.type(String.fromCharCode(13)),await s.waitFor(300);else if("eletype"===t.mode){await s.waitFor(300);let e=await f(t.selector,t.nth);e&&(await e.ele.click(),await s.waitFor(50),await s.keyboard.type(t.str,{delay:50}),t.noEnter||await s.keyboard.type(String.fromCharCode(13)),await s.waitFor(300))}else if("keypress"===t.mode){await s.waitFor(300);let e=Ge(t.count);e<=0&&(e=1);for(let r=0;r<e;r++)await s.keyboard.press(t.key);await s.waitFor(300)}else if("elefocus"===t.mode){await s.waitFor(300);let e=await f(t.selector,t.nth);e&&(await e.ele.focus(),await s.waitFor(300))}else console.log("mode is unrecognized: "+t.mode)})),await s.waitFor(2e3);let l=await s.screenshot({encoding:"base64"});return await s.close(),await c.close(),l}return async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=de(r,"headless"),o=de(r,"viewport"),a=de(r,"waitsec"),i=10;var u;return Le(u=r.num_web)&&Ge(u)>0&&(i=Ge(r.num_web)),function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n={},o=!1,a=to();if(!eo(t)&&!ro(t))return a.reject("rs is not an array or object"),a;let i=!1;if(ro(t)){i=!0;let e=[];en(t,((t,r)=>{e.push({k:r,v:t})})),t=e}let u=io(r);return u.on("message",(function(r){if(o)return;let c,s=u.get();if(no(e)){let t=s.key,r=s.value;i&&(t=s.value.k,r=s.value.v),c=e(r,t)}else c=s.value;c.then((t=>{n[s.key]=t})).catch((t=>{o=!0,u.clear(),a.reject(t)})).finally((()=>{u.cb(),Kn(n)===t.length&&a.resolve(Zn(n))}))})),en(t,((t,e)=>{u.push({key:e,value:t})})),a}(e,(async function(e){console.log("expBuild: "+e.name);let r={headless:n,viewport:o,actions:e.actions,waitsec:a},i=await ho(e.url,r);e.fn_png&&t.writeFileSync(e.fn_png,i,"base64"),e.fn_base64&&t.writeFileSync(e.fn_base64,i,"utf8"),console.log("success: "+e.name)}),i).then((()=>{console.log("[32m%s[0m","expBuild success")})).catch((t=>{console.log("[31m%s[0m","expBuild error: "+t)}))}}));
//# sourceMappingURL=expBuild.umd.js.map
